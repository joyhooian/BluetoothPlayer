(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/alarms/alarms"],{2786:function(e,t,i){"use strict";i.r(t);var a=i("340f"),n=i.n(a);for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},"2a1d":function(e,t,i){},"340f":function(e,t,i){"use strict";(function(e){var i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={name:"alarms",data:function(){return{devices:[],primaryServiceUUID:"",readUUID:"",writeUUID:"",uploadLoading:!1,CustomBar:this.CustomBar,alarmsInfo:[],alarmShow:{},timeAfterInfo:{},weekdaysString:[{index:0,string:"周一"},{index:1,string:"周二"},{index:2,string:"周三"},{index:3,string:"周四"},{index:4,string:"周五"},{index:5,string:"周六"},{index:6,string:"周日"}]}},methods:{Navigate:function(t){"set-time"===t.currentTarget.id?e.navigateTo({url:"/pages/alarms/set-time"}):"time-after"===t.currentTarget.id&&e.navigateTo({url:"/pages/alarms/time-after"})},uploadData:function(){var e=this;if(!this.uploadLoading)if(this.uploadLoading=!0,console.log(this.alarmShow),this.alarmShow.isSetTime){console.log("上传时间设定");var t=new Array;this.alarmsInfo.forEach((function(e,i){if(e.isUsing){var a=new Array;a.push("AT+TMST"+("0"+(i+1)).slice(-2)+"E1"),a.push("AT+TMST"+e.startTime.replace(":","")+e.stopTime.replace(":","")+"E1"),a.push("AT+TMSTV"+("0"+e.volume).slice(-2)+"E1"),a.push("AT+TMSTJ"+(e.relayStatus?"01":"00")+"E1");var n="AT+TMSTW";e.weekdays.forEach((function(e){n+=e+1})),n+="E0",a.push(n),t.push(a)}})),0==t.length?wx.showToast({title:"请启用要设置的任务!",icon:"none"}):""!=this.primaryServiceUUID&&""!=this.writeUUID&&(console.log("发送消息至: Service "+this.primaryServiceUUID+" Write "+this.writeUUID),t.forEach((function(t,i){t.forEach((function(t,a){setTimeout((function(){wx.writeBLECharacteristicValue({deviceId:e.devices[0].deviceId,serviceId:e.primaryServiceUUID,characteristicId:e.writeUUID,value:e.MessageToArrayBuffer(t),success:function(e){console.log("发送成功, 发送内容: "+t);var i=(new Date).getSeconds(),a=(new Date).getMilliseconds();console.log(i+":"+a)},fail:function(e){console.log("发送失败")}})}),250*i+50*a)}))})),setTimeout((function(){wx.writeBLECharacteristicValue({deviceId:e.devices[0].deviceId,serviceId:e.primaryServiceUUID,characteristicId:e.writeUUID,value:e.MessageToArrayBuffer("AT+TIMESETOVER"),success:function(e){console.log("发送成功, 发送内容: AT+TIMESETOVER");var t=(new Date).getSeconds(),i=(new Date).getMilliseconds();console.log(t+":"+i)},fail:function(e){console.log("发送失败 "+e.errMsg)},complete:function(){e.uploadLoading=!1}})}),250*t.length))}else if(this.alarmShow.isTimeAfter){console.log("上传间隔时间");var i=new Array;i.push("AT+TIMEJGT"+("0000"+this.timeAfterInfo.secAfter).slice(-4)),i.push("AT+TIMEJGV"+("0"+this.timeAfterInfo.volume).slice(-2)),i.push("AT+TIMEJGJ"+(this.timeAfterInfo.relayStatus?"01":"00")),console.log(i),i.forEach((function(t,i){setTimeout((function(){wx.writeBLECharacteristicValue({deviceId:e.devices[0].deviceId,serviceId:e.primaryServiceUUID,characteristicId:e.writeUUID,value:e.MessageToArrayBuffer(t),success:function(e){console.log("发送成功, 发送内容: "+t);var i=(new Date).getSeconds(),a=(new Date).getMilliseconds();console.log(i+":"+a),wx.showToast({title:"发送成功",icon:"none"})},fail:function(e){console.log("发送失败"),wx.showToast({title:"发送失败",icon:"none"})}})}),50*i)})),setTimeout((function(){wx.writeBLECharacteristicValue({deviceId:e.devices[0].deviceId,serviceId:e.primaryServiceUUID,characteristicId:e.writeUUID,value:e.MessageToArrayBuffer("AT+TIMEJGOVER"),success:function(e){console.log("发送成功, 发送内容: AT+TIMEJGOVER");var t=(new Date).getSeconds(),i=(new Date).getMilliseconds();console.log(t+":"+i),wx.showToast({title:"发送成功",icon:"none"})},fail:function(){console.log("发送失败"),wx.showToast({title:"发送失败",icon:"none"})},complete:function(){e.uploadLoading=!1}})}),150)}},ChagngUsing:function(e){this.alarmsInfo[e.currentTarget.id].isUsing=e.detail.value},Edit:function(t){e.navigateTo({url:"/pages/alarms/set-time?index="+t.currentTarget.id})}},created:function(){i=this,i.alarmsInfo=getApp().globalData.alarmsInfo,i.devices=getApp().globalData.devices,i.primaryServiceUUID=getApp().globalData.primaryServiceUUID,i.readUUID=getApp().globalData.readUUID,i.writeUUID=getApp().globalData.writeUUID,i.alarmShow=getApp().globalData.alarmShow,i.timeAfterInfo=getApp().globalData.timeAfterInfo,console.log(i)}};t.default=a}).call(this,i("543d")["default"])},a35a:function(e,t,i){"use strict";var a=i("2a1d"),n=i.n(a);n.a},bc19:function(e,t,i){"use strict";i.r(t);var a=i("f011"),n=i("2786");for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("a35a");var r,s=i("f0c5"),c=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);t["default"]=c.exports},f011:function(e,t,i){"use strict";var a;i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a}));var n=function(){var e=this,t=e.$createElement;e._self._c},o=[]},f9f8:function(e,t,i){"use strict";(function(e){i("29ac");a(i("66fd"));var t=a(i("bc19"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])}},[["f9f8","common/runtime","common/vendor"]]]);