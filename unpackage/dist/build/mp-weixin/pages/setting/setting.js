(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/setting/setting"],{"07ab":function(e,i,t){"use strict";t.r(i);var s=t("8f05"),o=t.n(s);for(var c in s)"default"!==c&&function(e){t.d(i,e,(function(){return s[e]}))}(c);i["default"]=o.a},"21de":function(e,i,t){"use strict";(function(e){t("29ac");s(t("66fd"));var i=s(t("6878"));function s(e){return e&&e.__esModule?e:{default:e}}e(i.default)}).call(this,t("543d")["createPage"])},6878:function(e,i,t){"use strict";t.r(i);var s=t("ca04"),o=t("07ab");for(var c in o)"default"!==c&&function(e){t.d(i,e,(function(){return o[e]}))}(c);t("f1f5");var n,a=t("f0c5"),r=Object(a["a"])(o["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],n);i["default"]=r.exports},"7cd1":function(e,i,t){},"8f05":function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s={name:"setting",data:function(){return{devices:[],primaryServiceUUID:"",readUUID:"",writeUUID:"",isSettingLight:!1,isDownloading:!1,isSelected:null,fileList:[],lightMode:"",valueListen:"",isMuted:!1,isSingle:!1,isAll:!1}},methods:{LightBack:function(){this.isSettingLight=!1},DownLoadData:function(){var e=this;this.isDownloading||(this.isDownloading=!0,console.log("下载文件"),wx.notifyBLECharacteristicValueChange({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.readUUID,state:!0,success:function(e){wx.showToast({title:"打开监听Notify成功",icon:"none"})},fail:function(e){wx.showToast({title:"打开监听Nofity失败",icon:"none"})}}),wx.onBLECharacteristicValueChange((function(i){if(wx.offBLEConnectionStateChange(),e.valueListen=e.ArrayBufferToMessage(i.value),-1!=e.valueListen.indexOf("AT+FILE")){e.fileList=[];for(var t=parseInt(e.valueListen.replace(/[^0-9]/gi,"")),s=1;s<=t;s++)e.fileList.push(s);wx.showToast({title:"成功读取"+t+"个文件",icon:"none"})}else wx.showToast({title:"未读取到文件, 请重新读取",icon:"none"});console.log("特征值 "+i.characteristicId+"已更新, 现在是"+e.valueListen)})),setTimeout((function(){wx.writeBLECharacteristicValue({deviceId:e.devices[0].deviceId,serviceId:e.primaryServiceUUID,characteristicId:e.writeUUID,value:e.MessageToArrayBuffer("AT+FILEREAD"),success:function(e){console.log("发送成功, 发送内容: AT+FILEREAD"),wx.showToast({title:"发送成功",icon:"none"})},fail:function(){console.log("发送失败"),wx.showToast({title:"发送失败",icon:"none"})}})}),100),setTimeout((function(){e.isDownloading=!1,wx.notifyBLECharacteristicValueChange({deviceId:e.devices[0].deviceId,serviceId:e.primaryServiceUUID,characteristicId:e.readUUID,state:!1}),wx.offBLEConnectionStateChange()}),500))},LightMode:function(){console.log("灯模式"),this.isSettingLight=!0},SelectLight:function(e){this.lightMode=e.currentTarget.id,console.log(this.lightMode)},UploadLightMode:function(){console.log("更新灯模式");var e="AT+"+this.lightMode;wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:this.MessageToArrayBuffer(e),success:function(e){console.log("发送数据成功 "+e.errMsg),wx.showToast({title:"更新灯模式成功",icon:"none"})},fail:function(e){console.log("发送数据失败 "+e.errMsg),wx.showToast({title:"更新灯模式失败",icon:"none"})}})},Mute:function(){var e=this;if(this.isMuted){this.isMuted=!1,getApp().globalData.isMuted=this.isMuted,console.log("取消静音");var i="AT+MUTEDIS";wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:this.MessageToArrayBuffer(i),success:function(e){console.log("发送数据成功 "+e.errMsg),wx.showToast({title:"取消静音成功",icon:"none"})},fail:function(e){console.log("发送数据失败 "+e.errMsg),wx.showToast({title:"取消静音失败",icon:"none"})}})}else{console.log("静音");i="AT+MUTEEN";wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:this.MessageToArrayBuffer(i),success:function(i){console.log("发送数据成功 "+i.errMsg),wx.showToast({title:"静音成功",icon:"none"}),e.isMuted=!0,getApp().globalData.isMuted=e.isMuted},fail:function(e){console.log("发送数据失败 "+e.errMsg),wx.showToast({title:"静音失败",icon:"none"})}})}},Single:function(){var e=this;console.log("单曲");var i="AT+ONLY";wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:this.MessageToArrayBuffer(i),success:function(i){console.log("发送数据成功 "+i.errMsg),wx.showToast({title:"设置单曲播放成功",icon:"none"}),e.isSingle=!0,e.isAll=!1,getApp().globalData.isSingle=e.isSingle,getApp().globalData.isAll=e.isAll},fail:function(e){console.log("发送数据失败 "+e.errMsg),wx.showToast({title:"设置单曲播放失败",icon:"none"})}})},All:function(){var e=this;console.log("循环");var i="AT+ALL";wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:this.MessageToArrayBuffer(i),success:function(i){console.log("发送数据成功 "+i.errMsg),wx.showToast({title:"设置循环播放成功",icon:"none"}),e.isSingle=!1,e.isAll=!0,getApp().globalData.isSingle=e.isSingle,getApp().globalData.isAll=e.isAll},fail:function(e){console.log("发送数据失败 "+e.errMsg),wx.showToast({title:"设置循坏播放失败",icon:"none"})}})},Delete:function(){console.log("删除");var e="AT+DLE"+(this.isSelected+1<10?"0"+(this.isSelected+1):this.isSelected+1);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:this.MessageToArrayBuffer(e),success:function(e){console.log("发送数据成功 "+e.errMsg),wx.showToast({title:"删除文件成功",icon:"none"})},fail:function(e){console.log("发送数据失败 "+e.errMsg),wx.showToast({title:"删除文件失败",icon:"none"})}}),this.fileList.splice(this.isSelected,1),this.isSelected=null},Select:function(e){this.isSelected=parseInt(e.currentTarget.id),console.log("文件"+(this.isSelected+1)+"被选中")},Play:function(e){var i=("0"+(parseInt(e.currentTarget.id)+1)).slice(-2),t="AT+PLAY"+i;wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:this.MessageToArrayBuffer(t),success:function(e){console.log("成功发送试听命令"+e.errMsg),wx.showToast({title:"成功发送试听命令",icon:"none"})},fail:function(e){console.log("发送试听命令失败"+e.errMsg),wx.showToast({title:"发送试听命令失败",icon:"none"})}})}},created:function(){this.devices=getApp().globalData.devices,this.primaryServiceUUID=getApp().globalData.primaryServiceUUID,this.readUUID=getApp().globalData.readUUID,this.writeUUID=getApp().globalData.writeUUID,this.isMuted=getApp().globalData.isMuted,this.isSingle=getApp().globalData.isSingle,this.isAll=getApp().globalData.isAll,console.log(this)}};i.default=s},ca04:function(e,i,t){"use strict";var s;t.d(i,"b",(function(){return o})),t.d(i,"c",(function(){return c})),t.d(i,"a",(function(){return s}));var o=function(){var e=this,i=e.$createElement;e._self._c},c=[]},f1f5:function(e,i,t){"use strict";var s=t("7cd1"),o=t.n(s);o.a}},[["21de","common/runtime","common/vendor"]]]);