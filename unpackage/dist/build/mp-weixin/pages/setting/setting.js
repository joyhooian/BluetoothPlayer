(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/setting/setting"],{"07ab":function(e,i,t){"use strict";t.r(i);var s=t("8f05"),o=t.n(s);for(var n in s)"default"!==n&&function(e){t.d(i,e,(function(){return s[e]}))}(n);i["default"]=o.a},"21de":function(e,i,t){"use strict";(function(e){t("29ac");s(t("66fd"));var i=s(t("6878"));function s(e){return e&&e.__esModule?e:{default:e}}e(i.default)}).call(this,t("543d")["createPage"])},6878:function(e,i,t){"use strict";t.r(i);var s=t("f069"),o=t("07ab");for(var n in o)"default"!==n&&function(e){t.d(i,e,(function(){return o[e]}))}(n);t("f1f5");var c,a=t("f0c5"),r=Object(a["a"])(o["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],c);i["default"]=r.exports},"7cd1":function(e,i,t){},"8f05":function(e,i,t){"use strict";(function(e){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var t={name:"setting",data:function(){return{devices:[],primaryServiceUUID:"",readUUID:"",writeUUID:"",isSettingLight:!1,isDownloading:!1,isSelected:null,fileList:[],lightMode:"MODE01",valueListen:"",isMuted:!1,isSingle:!1,isAll:!1,isPlayWhenBoot:!1,isTimingCancel:!1}},methods:{LightBack:function(){this.isSettingLight=!1},ChangeLightMode:function(e){this.lightMode=e.detail.value,console.log(this.lightMode)},DownLoadData:function(){var i=this;console.log("下载文件"),e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),this.isDownloading||0==this.devices.length||(this.isDownloading=!0,wx.notifyBLECharacteristicValueChange({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.readUUID,state:!0,success:function(i){e.showToast({title:"打开监听Notify成功",icon:"none"})},fail:function(i){e.showToast({title:"打开监听Nofity失败",icon:"none"})}}),wx.onBLECharacteristicValueChange((function(t){wx.offBLECharacteristicValueChange();var s=new Uint8Array(t.value);console.log(s);for(var o=[126,4,32],n=0;n<s.length;n++)for(var c=0;c<3;c++){if(s[n+c]!=o[c])break;if(2==c){i.fileList=[];for(var a=s[n+c+1]<<8|s[n+c+2],r=1;r<=a;r++)i.fileList.push(r);e.showToast({title:"成功读取"+a+"个文件",icon:"none"})}}setTimeout((function(){0==i.fileList.length&&e.showToast({title:"读取失败, 请再试一次",icon:"none"})}),100),console.log("特征值 "+t.characteristicId+"已更新, 现在是"+i.valueListen)})),setTimeout((function(){var t=new Array;t.push(126),t.push(2),t.push(25),t.push(239);var s=new Uint8Array(t);wx.writeBLECharacteristicValue({deviceId:i.devices[0].deviceId,serviceId:i.primaryServiceUUID,characteristicId:i.writeUUID,value:s.buffer,success:function(i){console.log("发送成功"),console.log(s.buffer),e.showToast({title:"发送成功",icon:"none"})},fail:function(){console.log("发送失败"),e.showToast({title:"发送失败",icon:"none"})}})}),100),setTimeout((function(){i.isDownloading=!1,wx.notifyBLECharacteristicValueChange({deviceId:i.devices[0].deviceId,serviceId:i.primaryServiceUUID,characteristicId:i.readUUID,state:!1}),wx.offBLECharacteristicValueChange()}),500))},LightMode:function(){console.log("灯模式"),this.isSettingLight=!0},UploadLightMode:function(){if(console.log("更新灯模式"),e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),this.isSettingLight=!1,this.devices.length){var i=new Array;i.push(126),i.push(3),i.push(23),i.push(Number(this.lightMode.substr(5,1))),i.push(239);var t=new Uint8Array(i);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:t.buffer,success:function(i){console.log("发送数据成功"),console.log(t.buffer),e.showToast({title:"更新灯模式成功",icon:"none"})},fail:function(i){console.log("发送数据失败"),e.showToast({title:"更新灯模式失败",icon:"none"})}})}},Mute:function(){var i=this;if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),this.isMuted){if(console.log("取消静音"),this.devices.length){var t=new Array;t.push(126),t.push(3),t.push(21),t.push(0),t.push(239);var s=new Uint8Array(t);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:s.buffer,success:function(t){console.log("发送数据成功"),console.log(s.buffer),i.isMuted=!1,getApp().globalData.isMuted=i.isMuted,e.showToast({title:"取消静音成功",icon:"none"})},fail:function(i){console.log("发送数据失败"),e.showToast({title:"取消静音失败",icon:"none"})}})}}else if(console.log("静音"),this.devices.length){var o=new Array;o.push(126),o.push(3),o.push(21),o.push(1),o.push(239);var n=new Uint8Array(o);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:n.buffer,success:function(t){console.log("发送数据成功"),console.log(n.buffer),i.isMuted=!0,getApp().globalData.isMuted=i.isMuted,e.showToast({title:"静音成功",icon:"none"}),i.isMuted=!0,getApp().globalData.isMuted=i.isMuted},fail:function(i){console.log("发送数据失败"),e.showToast({title:"静音失败",icon:"none"})}})}},Single:function(){var i=this;if(console.log("单曲"),e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),this.devices.length){var t=new Array;t.push(126),t.push(2),t.push(33),t.push(239);var s=new Uint8Array(t);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:s.buffer,success:function(t){console.log("发送数据成功"),console.log(s.buffer),e.showToast({title:"设置单曲播放成功",icon:"none"}),i.isSingle=!0,i.isAll=!1,getApp().globalData.isSingle=i.isSingle,getApp().globalData.isAll=i.isAll},fail:function(i){console.log("发送数据失败"),e.showToast({title:"设置单曲播放失败",icon:"none"})}})}},All:function(){var i=this;if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),console.log("循环"),this.devices.length){var t=new Array;t.push(126),t.push(2),t.push(22),t.push(239);var s=new Uint8Array(t);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:s.buffer,success:function(t){console.log("发送数据成功"),console.log(s.buffer),e.showToast({title:"设置循环播放成功",icon:"none"}),i.isSingle=!1,i.isAll=!0,getApp().globalData.isSingle=i.isSingle,getApp().globalData.isAll=i.isAll},fail:function(i){console.log("发送数据失败"),e.showToast({title:"设置循坏播放失败",icon:"none"})}})}},Delete:function(){var i=this;if(console.log("删除"),e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),this.devices.length&&this.isSelected){var t=new Array;t.push(126),t.push(3),t.push(20),t.push(this.isSelected+1),t.push(239);var s=new Uint8Array(t);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:s.buffer,success:function(t){console.log("发送数据成功"),console.log(s.buffer),i.fileList.splice(i.isSelected,1),i.isSelected=null,e.showToast({title:"删除文件成功",icon:"none"})},fail:function(i){console.log("发送数据失败 "+i.errMsg),e.showToast({title:"删除文件失败",icon:"none"})}})}},Select:function(e){this.isSelected=parseInt(e.currentTarget.id),console.log("文件"+(this.isSelected+1)+"被选中")},Play:function(i){if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),this.devices.length){var t=new Array;t.push(126),t.push(4),t.push(65),t.push((parseInt(i.currentTarget.id)+1&65280)>>8),t.push(parseInt(i.currentTarget.id)+1&255),t.push(239);var s=new Uint8Array(t);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:s.buffer,success:function(i){console.log("成功发送试听命令"),console.log(s.buffer),e.showToast({title:"成功发送试听命令",icon:"none"})},fail:function(i){console.log("发送试听命令失败"),e.showToast({title:"发送试听命令失败",icon:"none"})}})}},PlayWhenBoot:function(){var i=this;if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),console.log("上电播放"),this.devices.length){var t=new Array;t.push(126),t.push(2),t.push(34),t.push(239);var s=new Uint8Array(t);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:s.buffer,success:function(t){console.log("上电播放发送成功"),console.log(s.buffer),i.isPlayWhenBoot=!0,getApp().globalData.isPlayWhenBoot=i.isPlayWhenBoot,e.showToast({title:"上电播放发送成功",icon:"none"})},fail:function(i){console.log("上电播放发送失败"),e.showToast({title:"上电播放发送失败",icon:"none"})}})}},ShutdownBoot:function(){if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),console.log("开关机"),this.devices.length){var i=new Array;i.push(126),i.push(2),i.push(130),i.push(239);var t=new Uint8Array(i);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:t.buffer,success:function(i){console.log("开关机成功"),console.log(t.buffer),e.showToast({title:"开关机成功",icon:"none"})},fail:function(i){console.log("开关机失败"),e.showToast({title:"开关机失败",icon:"none"})}})}},TimingCancel:function(){var i=this;if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),console.log("取消定时"),this.devices.length){var t=new Array;t.push(126),t.push(2),t.push(132),t.push(239);var s=new Uint8Array(t);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:s.buffer,success:function(t){console.log("取消定时成功"),console.log(s.buffer),i.isTimingCancel=!0,getApp().globalData.isTimingCancel=!0,e.showToast({title:"取消定时成功",icon:"none"})},fail:function(i){console.log("取消定时失败"),e.showToast({title:"取消定时失败",icon:"none"})}})}},Last:function(){if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),console.log("上一首"),this.devices.length){var i=new Array;i.push(126),i.push(2),i.push(133),i.push(239);var t=new Uint8Array(i);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:t.buffer,success:function(i){console.log("上一首发送成功"),console.log(t.buffer),e.showToast({title:"上一首发送成功",icon:"none"})},fail:function(i){console.log("上一首发送失败"),e.showToast({title:"上一首发送失败",icon:"none"})}})}},Next:function(){if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),console.log("下一首"),this.devices.length){var i=new Array;i.push(126),i.push(2),i.push(134),i.push(239);var t=new Uint8Array(i);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:t.buffer,success:function(i){console.log("下一首发送成功"),console.log(t.buffer),e.showToast({title:"下一首发送成功",icon:"none"})},fail:function(i){console.log("下一首发送失败"),e.showToast({title:"下一首发送失败",icon:"none"})}})}},Stop:function(){if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),console.log("停止"),this.devices.length){var i=new Array;i.push(126),i.push(2),i.push(131),i.push(239);var t=new Uint8Array(i);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:t.buffer,success:function(i){console.log("停止发送成功"),console.log(t.buffer),e.showToast({title:"停止发送成功",icon:"none"})},fail:function(i){console.log("停止发送失败"),e.showToast({title:"停止发送失败",icon:"none"})}})}},VolumeIncrease:function(){if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),console.log("音量加"),this.devices.length){var i=new Array;i.push(126),i.push(2),i.push(128),i.push(239);var t=new Uint8Array(i);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:t.buffer,success:function(i){console.log("音量加发送成功"),console.log(t.buffer),e.showToast({title:"音量加发送成功",icon:"none"})},fail:function(i){console.log("音量加发送失败"),e.showToast({title:"音量加发送失败",icon:"none"})}})}},VolumeDecrease:function(){if(e.showToast({title:"请稍后...",icon:"loading",duration:1e3,mask:!0}),console.log("音量减"),this.devices.length){var i=new Array;i.push(126),i.push(2),i.push(129),i.push(239);var t=new Uint8Array(i);wx.writeBLECharacteristicValue({deviceId:this.devices[0].deviceId,serviceId:this.primaryServiceUUID,characteristicId:this.writeUUID,value:t.buffer,success:function(i){console.log("音量减发送成功"),console.log(t.buffer),e.showToast({title:"音量减发送成功",icon:"none"})},fail:function(i){console.log("音量减发送失败"),e.showToast({title:"音量减发送失败",icon:"none"})}})}}},beforeCreate:function(){console.log("进入设置页面")},created:function(){this.devices=getApp().globalData.devices,this.primaryServiceUUID=getApp().globalData.primaryServiceUUID,this.readUUID=getApp().globalData.readUUID,this.writeUUID=getApp().globalData.writeUUID,this.isMuted=getApp().globalData.isMuted,this.isSingle=getApp().globalData.isSingle,this.isAll=getApp().globalData.isAll,this.isTimingCancel=getApp().globalData.isTimingCancel,this.isPlayWhenBoot=getApp().globalData.isPlayWhenBoot},mounted:function(){}};i.default=t}).call(this,t("543d")["default"])},f069:function(e,i,t){"use strict";var s;t.d(i,"b",(function(){return o})),t.d(i,"c",(function(){return n})),t.d(i,"a",(function(){return s}));var o=function(){var e=this,i=e.$createElement;e._self._c},n=[]},f1f5:function(e,i,t){"use strict";var s=t("7cd1"),o=t.n(s);o.a}},[["21de","common/runtime","common/vendor"]]]);